<div class="detailed-session-card">
  <div class="session-header">
    <h2>{{ sessionDate | date: 'fullDate' }}</h2>
    <p class="session-info">
      <strong>{{ session.groupName }}</strong> hosted by {{ session.hostName }}
    </p>
    <p class="session-status" [class.confirmed]="session.isConfirmed">
      {{ session.isConfirmed ? 'Confirmed' : 'Tentative' }}
    </p>
  </div>

  <div class="session-details">
    <div class="detail-section">
      <h3>Available Players ({{ availablePlayers.length }})</h3>
      <div class="player-count">
        <p>{{ availablePlayers.length }} players confirmed</p>
      </div>
      
      @if (currentUser && isFutureSession) {
        <div class="player-actions">
          @if (!isPlayerAvailable) {
            <button 
              class="btn btn-join" 
              (click)="addPlayerToSession()" 
              [disabled]="isProcessing">
              {{ isProcessing ? 'Joining...' : 'Join Session' }}
            </button>
          } @else {
            <button 
              class="btn btn-leave" 
              (click)="removePlayerFromSession()" 
              [disabled]="isProcessing">
              {{ isProcessing ? 'Leaving...' : 'Leave Session' }}
            </button>
          }
        </div>
      }
    </div>

    <div class="detail-section">
      <h3>Snacks</h3>
      <p class="detail-content">{{ snacks || 'No snack information' }}</p>
      
      @if (currentUser && isFutureSession) {
        @if (hasUserSnack) {
          <div class="action-group">
            <button 
              class="btn btn-remove" 
              (click)="removeSnackInfo()" 
              [disabled]="isProcessing">
              {{ isProcessing ? 'Removing...' : 'Remove My Snack' }}
            </button>
          </div>
        } @else {
          <div class="input-group">
            <input 
              type="text" 
              [(ngModel)]="snackInput" 
              placeholder="What will you bring? (e.g., chips, cookies, etc.)"
              class="text-input"
              [disabled]="isProcessing">
            <button 
              class="btn btn-add" 
              (click)="addSnackInfo()" 
              [disabled]="isProcessing || !snackInput.trim()">
              {{ isProcessing ? 'Adding...' : 'Add Snack' }}
            </button>
          </div>
        }
      }
    </div>

    <div class="detail-section">
      <h3>Carpool</h3>
      <p class="detail-content">{{ carpool || 'No carpool information' }}</p>
      
      @if (currentUser && isFutureSession) {
        @if (hasUserCarpool) {
          <div class="action-group">
            <button 
              class="btn btn-remove" 
              (click)="removeCarpoolInfo()" 
              [disabled]="isProcessing">
              {{ isProcessing ? 'Removing...' : 'Remove My Carpool' }}
            </button>
          </div>
        } @else {
          <div class="input-group">
            <input 
              type="text" 
              [(ngModel)]="carpoolInput" 
              placeholder="Offer a ride or request carpool"
              class="text-input"
              [disabled]="isProcessing">
            <button 
              class="btn btn-add" 
              (click)="addCarpoolInfo()" 
              [disabled]="isProcessing || !carpoolInput.trim()">
              {{ isProcessing ? 'Adding...' : 'Offer Ride' }}
            </button>
          </div>
        }
      }
    </div>

    @if (externalAvailability) {
      <div class="detail-section">
        <h3>External Availability</h3>
        <p class="detail-content">{{ externalAvailability }}</p>
      </div>
    }

    @if (sessionSynopsis) {
      <div class="notes-section">
        <app-note-card 
          [sessionDate]="sessionDate"
          [synopsis]="sessionSynopsis">
        </app-note-card>
      </div>
    }

    @if (isDM && secretNotes) {
      <div class="notes-section">
        <app-secret-note-card 
          [descriptiveNotes]="secretNotes">
        </app-secret-note-card>
      </div>
    }
  </div>
</div>
